"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),PillarList=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.randomNumber=Math.round(1e5*Math.random()),n}return _inherits(e,_react.Component),_createClass(e,[{key:"componentDidMount",value:function(){var t=this.props,e=t.data,n=t.style,r=t.colors||["#29AAFF","#0DF29E","#00D1C6","#ff0000","#00ff00"],i=document.createElement("canvas"),a=document.getElementById("canvasContainer"+this.randomNumber);i.width=n&&"width"in n?2*n.width:800,i.height=n&&"height"in n?2*n.height:600,i.style.width=n&&"width"in n?n.width+"px":"400px",i.style.height=n&&"height"in n?n.height+"px":"300px",a.appendChild(i);var o=i.getContext("2d"),h=function(t,e){var n=parseInt(t.substr(1),16),r=Math.round(2.55*e),i=(n>>16)+r,a=(n>>8&255)+r,o=(255&n)+r;return"rgba("+(i<255?i<1?0:i:255)+","+(a<255?a<1?0:a:255)+","+(o<255?o<1?0:o:255)+",0.82)"},l=function(t,e,n,r,i,a){o.beginPath(),o.moveTo(t,e),o.lineTo(t-n,e-.5*n),o.lineTo(t-n,e-i-.5*n),o.lineTo(t,e-1*i),o.closePath(),o.fillStyle=h(a,-10),o.strokeStyle=a,o.stroke(),o.fill(),o.beginPath(),o.moveTo(t,e),o.lineTo(t+r,e-.5*r),o.lineTo(t+r,e-i-.5*r),o.lineTo(t,e-1*i),o.closePath(),o.fillStyle=h(a,10),o.strokeStyle=h(a,50),o.stroke(),o.fill(),o.beginPath(),o.moveTo(t,e-i),o.lineTo(t-n,e-i-.5*n),o.lineTo(t-n+r,e-i-(.5*n+.5*r)),o.lineTo(t+r,e-i-.5*r),o.closePath(),o.fillStyle=h(a,20),o.strokeStyle=h(a,60),o.stroke(),o.fill()},s=function(t,e,n,i,a,h,l){var s=Math.floor(.5*n),c=Math.floor(.38*n),p=100*l.percent+"%",u=l.name.length/2*c,f=t-n,d=e-.7*a-.5*n,M=t-2*n,y=e-.7*a-.5*n,P=t-3*n,_=e-.8*a-.5*n,b=t-3*n-u,w=e-.8*a-.5*n-1.8*s,g=e-.8*a-.5*n-c;h%2!=0&&(f=t+i,d=e-i-.5*a,M=t+2*i,y=e-i-.5*a,P=t+3*i,_=e-i-.6*a,b=t+3*i-u,w=e-i-.6*a-1.8*s,g=e-i-.6*a-c),o.beginPath(),o.strokeStyle="#999",o.moveTo(f,d),o.lineTo(M,y),o.lineTo(P,_),o.stroke(),o.fillStyle=r[h],o.font=s+"px Microsoft YaHei",o.fillText(p,b,w),o.fillStyle="#000",o.font=c+"px Microsoft YaHei",o.fillText(l.name,b,g)};!function(){if(o.clearRect(0,0,i.width,i.height),e.sort(function(t,e){return t.percent<e.percent}),e&&e.length){var t=e.length,n=i.height,a=[],h=[],c=[],p=i.width/3/4,u=.988*i.height-p*Math.sin(Math.PI/3)*1.2;switch(t){case 5:p=i.width/3/5,u=.988*i.height-p*Math.sin(Math.PI/3)*1.2,c=[n-p/Math.sin(Math.PI/3),n-p/Math.sin(Math.PI/3)/2,n-p/Math.sin(Math.PI/3)/2,.988*n,.988*n],a=[u*e[0].percent-p/Math.sin(Math.PI/3),u*e[1].percent-p/Math.sin(Math.PI/3)/2,u*e[2].percent-p/Math.sin(Math.PI/3)/2,u*e[3].percent,u*e[4].percent],h=[i.width/15*8,i.width/15*9,i.width/15*7,i.width/15*8,i.width/15*6];break;case 4:c=[n-p/Math.sin(Math.PI/3),n-p/Math.sin(Math.PI/3)/2,n-p/Math.sin(Math.PI/3)/2,.988*n],a=[u*e[0].percent-p/Math.sin(Math.PI/3),u*e[1].percent-p/Math.sin(Math.PI/3)/2,u*e[2].percent-p/Math.sin(Math.PI/3)/2,u*e[3].percent],h=[i.width/2,i.width/12*7,i.width/12*5,i.width/2];break;default:c=[n-p/Math.sin(Math.PI/3),n-p/Math.sin(Math.PI/3)/2,n-p/Math.sin(Math.PI/3)/2],a=[u*e[0].percent-p/Math.sin(Math.PI/3),u*e[1].percent-p/Math.sin(Math.PI/3)/2,u*e[2].percent-p/Math.sin(Math.PI/3)/2],h=[i.width/2,i.width/12*7,i.width/12*5]}for(var f=0;f<t;f++)l(h[f],c[f],p,p,a[f],r[f]),s(h[f],c[f],p,p,a[f],f,e[f])}}()}},{key:"render",value:function(){return _react2.default.createElement("div",{id:"canvasContainer"+this.randomNumber,className:"canvas-container",style:{textAlign:"center"}})}}]),e}();exports.default=PillarList,PillarList.propTypes={data:_propTypes2.default.array.isRequired};