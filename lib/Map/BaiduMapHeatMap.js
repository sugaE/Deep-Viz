"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _objectWithoutProperties(e,t){var r={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_propTypes=require("prop-types"),_propTypes2=_interopRequireDefault(_propTypes),_BaiduMapControlBase2=require("./BaiduMapControlBase"),_BaiduMapControlBase3=_interopRequireDefault(_BaiduMapControlBase2),disZoomMap=[[50,18],[100,17],[200,16],[500,15],[1e3,14],[2e3,13],[5e3,12],[1e4,11],[2e4,10],[25e3,9],[5e4,8],[1e5,7],[2e5,6],[5e5,5],[1e6,4],[2e6,3]],BaiduMapHeatMap=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_BaiduMapControlBase3.default),_createClass(t,[{key:"render",value:function(){function e(){var e=window.BMap,t=new e.Map("map"+y),r=void 0;if(o)r=new e.Point(o.lng,o.lat),t.centerAndZoom(r,13);else if(1===n.length)r=new e.Point(n[0].lng,n[0].lat),t.centerAndZoom(r,13);else{for(var a=0,i=void 0,u=void 0,l=0;l<n.length-1;l++)for(var _=l;_<n.length;_++){var b=t.getDistance(new e.Point(n[l].lng,n[l].lat),new e.Point(n[_].lng,n[_].lat));b>a&&(i=(n[l].lng+n[_].lng)/2,u=(n[l].lat+n[_].lat)/2,a=b)}r=new e.Point(i,u);var h=disZoomMap.filter(function(e){return e[0]>a});h.length>1&&t.centerAndZoom(r,h[0][1]>16?18:h[0][1]+2)}f(t,c),t.clearOverlays();var m=document.createElement("script");m.async=!0,m.type="text/javascript",m.src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js",document.head.appendChild(m),m.onload=function(){var e=new window.BMapLib.HeatmapOverlay({radius:p,opacity:s,gradient:d});t.addOverlay(e),e.setDataSet({data:n,max:100}),e.show()}}var t=this.props,r=t.style,a=void 0===r?{}:r,o=t.point,n=t.datas,i=t.radius,p=void 0===i?20:i,u=t.opacity,s=void 0===u?0:u,l=t.gradient,d=void 0===l?{.45:"rgb(0,0,255)",.55:"rgb(0,255,255)",.65:"rgb(0,255,0)",.95:"yellow",1:"rgb(255,0,0)"}:l,c=_objectWithoutProperties(t,["style","point","datas","radius","opacity","gradient"]),f=this.initMapControl,y=Math.random();return window["mapload"+y.toString().substr(2)]=e,void 0===window.BMap?function(){var e=document.createElement("script");e.src="http://api.map.baidu.com/api?v=2.0&ak=C4f54f1b740bc62107184968edbb64fb&callback=mapload"+y.toString().substr(2),document.body.appendChild(e)}():setTimeout(e,0),_react2.default.createElement("div",{id:"map"+y,style:_extends({height:"100%",width:"100%"},a)})}}]),t}();BaiduMapHeatMap.propTypes={style:_propTypes2.default.object,point:_propTypes2.default.shape({lat:_propTypes2.default.number.isRequired,lng:_propTypes2.default.number.isRequired}),datas:_propTypes2.default.arrayOf(_propTypes2.default.shape({lat:_propTypes2.default.number.isRequired,lng:_propTypes2.default.number.isRequired,count:_propTypes2.default.number.isRequired})).isRequired,opacity:_propTypes2.default.number,radius:_propTypes2.default.number,gradient:_propTypes2.default.object},exports.default=BaiduMapHeatMap;